
Sub 全文页边距和页眉_页脚格式()
response = MsgBox("【重要提示】" & Chr(13) & "确认后会覆盖已修改的页眉" & Chr(13) & "请谨慎点击确定", buttons:=vbOKCancel + vbDefaultButton2)
    If response = 1 Then
        response = MsgBox("【再次确认】" & Chr(13) & "你确定修改吗？", buttons:=vbOKCancel + vbDefaultButton2)
        If response <> 1 Then
            Exit Sub
        End If
    Else
        Exit Sub
    End If

    Selection.WholeStory'设置页边距
    With ActiveDocument.PageSetup
        .TopMargin = CentimetersToPoints(3)
        .BottomMargin = CentimetersToPoints(3)
        .LeftMargin = CentimetersToPoints(3)
        .RightMargin = CentimetersToPoints(3)
    End With
    Selection.ParagraphFormat.LineSpacingRule = wdLineSpace1pt5

    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader'设置页眉
    Selection.HomeKey unit:=wdLine
    Selection.EndKey unit:=wdLine, Extend:=wdExtend
    Selection.Delete 
    Selection.TypeText Text:="电子科技大学学士学位论文"
    Selection.HomeKey unit:=wdLine
    Selection.EndKey unit:=wdLine, Extend:=wdExtend
    Selection.Font.Name = "宋体"
    Selection.Font.Size = 10.5

ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
    Selection.HomeKey unit:=wdLine
    Selection.EndKey unit:=wdLine, Extend:=wdExtend
    Selection.Delete'进行更新删除
    Selection.TypeText Text:=""
    Selection.HomeKey unit:=wdLine
    Selection.EndKey unit:=wdLine, Extend:=wdExtend
    Selection.Font.Name = "宋体"
    Selection.Font.Size = 10.5
    
    Selection.PageSetup.HeaderDistance = 56.6' 设置页眉到页面底边的距离
    Selection.PageSetup.FooterDistance = 56.6 ' 设置页脚到页面底边的距离
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    Selection.HomeKey
    MsgBox "完成！"
End Sub

Sub 英文数字_页眉格式()
     If Selection.Type = wdSelectionIP Then
        Selection.Expand unit:=wdParagraph
    ElseIf Selection.Type <> wdSelectionNormal Then
        MsgBox "请选定文字！"
        Exit Sub
    End If
    response = MsgBox("此操作用于设置英文数字页眉的格式" & Chr(13), buttons:=vbOKCancel + vbDefaultButton2)
    If response <> 1 Then
            Exit Sub
    End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader '设置页眉
    Selection.Font.Name = "Times New Roman"
    Selection.Font.Size = 10.5
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
End Sub


Sub 全文英文使用新罗马字体()
    On Error GoTo msg
    Dim ps As Paragraphs
    Set ps = ActiveDocument.Paragraphs
    n = ps.Count
    For i = 1 To n
        For Each C In ps(i).Range.Characters
            If VBA.Asc(C) >= 0 And C.Font.Name <> "Times New Roman" Then
                C.Font.Name = "Times New Roman"
            End If
        Next
    Next
    MsgBox "完成！"
    Exit Sub
msg:
    MsgBox "出了点问题，请检查后重试  >_<", Title:="Error", buttons:=vbCritical
End Sub

Sub 正文_中文()
    If Selection.Type = wdSelectionIP Then
        Selection.Expand unit:=wdParagraph
    ElseIf Selection.Type <> wdSelectionNormal Then
        MsgBox "请选定文字！"
        Exit Sub
    End If
    Selection.ClearFormatting
    Selection.Font.Name = "宋体"
    Selection.Font.Size = 12
    Selection.Font.Bold = False
    Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly
    Selection.ParagraphFormat.LineSpacing = 20'固定行距20磅
    With Selection.ParagraphFormat
        .SpaceBefore = 0
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        '.LineSpacingRule = wdLineSpace1pt5
        .CharacterUnitFirstLineIndent = 2'首行缩进两字符
        .OutlineLevel = wdOutlineLevelBodyText
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With
End Sub
Sub 正文_英文()
    If Selection.Type = wdSelectionIP Then
        Selection.Expand unit:=wdParagraph
    ElseIf Selection.Type <> wdSelectionNormal Then
        MsgBox "请选定英文！"
        Exit Sub
    End If
    Selection.ClearFormatting
    Selection.Font.Name = "Times New Roman"
    Selection.Font.Size = 12
    
    Selection.Font.Bold = False
    Selection.ParagraphFormat.LineSpacingRule = wdLineSpaceExactly
    Selection.ParagraphFormat.LineSpacing = 20
    With Selection.ParagraphFormat
        .SpaceBefore = 0
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        '.LineSpacingRule = wdLineSpace1pt5
        .CharacterUnitFirstLineIndent = 2'首行缩进两字符
        .OutlineLevel = wdOutlineLevelBodyText
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With
End Sub

Sub 生成页码()
    response = MsgBox("【重要提示】" & Chr(13) & "请确保光标位于第一章的一级标题前" & Chr(13) & "再点击[确定]  否则点击[取消]", buttons:=vbOKCancel + vbDefaultButton2)
    If response = 1 Then
        response = MsgBox("【再次确认】" & Chr(13) & "我确认光标位于正确位置", buttons:=vbOKCancel + vbDefaultButton2)
        If response <> 1 Then
            Exit Sub
        End If
    Else
        Exit Sub
    End If

    Selection.InsertBreak Type:=wdSectionBreakNextPage
    
    With ActiveDocument.Sections(1)
        .Footers(wdHeaderFooterPrimary).PageNumbers.Add PageNumberAlignment:=wdAlignPageNumberCenter, FirstPage:=True
        .Footers(wdHeaderFooterPrimary).PageNumbers.StartingNumber = 1
        .Footers(wdHeaderFooterPrimary).PageNumbers.NumberStyle = wdPageNumberStyleUppercaseRoman'第一章之前用新罗马字体
        .Footers(wdHeaderFooterPrimary).Range.Font.Name = "Times New Roman"
        .Footers(wdHeaderFooterPrimary).Range.Font.Size = 9
        '.Headers(1).Range.ParagraphFormat.Borders(3).LineStyle = wdLineStyleNone
    End With
    With ActiveDocument.Sections(2)
        .Footers(wdHeaderFooterPrimary).PageNumbers.Add PageNumberAlignment:=wdAlignPageNumberCenter, FirstPage:=True
        .Footers(wdHeaderFooterPrimary).PageNumbers.RestartNumberingAtSection = True
        .Footers(wdHeaderFooterPrimary).PageNumbers.StartingNumber = 1
        .Footers(wdHeaderFooterPrimary).PageNumbers.NumberStyle = wdPageNumberStyleArabic
        .Footers(wdHeaderFooterPrimary).Range.Font.Name = "Times New Roman"
        .Footers(wdHeaderFooterPrimary).Range.Font.Size = 9
        '.Headers(1).Range.ParagraphFormat.Borders(3).LineStyle = wdLineStyleNone
    End With
    MsgBox "完成！"
End Sub


Sub 插入脚注()
    With Selection
        With .FootnoteOptions
            .Location = wdBottomOfPage
            '.NumberingRule = wdRestartSection
            '.NumberingRule = wdRestartContinuous
            .StartingNumber = 1
            .NumberStyle = wdNoteNumberStyleNumberInCircle
            .LayoutColumns = 1
        End With
        .Font.Size = 10.5
        .ParagraphFormat.Alignment = 3
        .ParagraphFormat.LineSpacingRule = pbLineSpacingSingle'单倍行距
        .ParagraphFormat.LineUnitBefore = 0 '段前距
        .ParagraphFormat.LineUnitAfter = 0 '段后距
        Set myRange = ActiveDocument.Sections(1).Range
    If myRange.Footnotes.NumberingRule = wdRestartSection Then
        myRange.Footnotes.NumberingRule = wdRestartPage
    End If
        .Footnotes.Add Range:=Selection.Range, Reference:=""
    End With
End Sub

